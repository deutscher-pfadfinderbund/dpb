{% extends "base.html" %}

{% load staticfiles %}
{% load pages %}
{% load thumbnail %}
{% load intern_tags %}

{% block heading %}
  <h1>Dokumente</h1>
{% endblock %}

{% block content %}
  {% if user.is_staff %}
    <p>
      <a href="/admin/filer/folder/">Weitere Dokumente hochladen</a>
    </p>
  {% endif %}

  {% for folder in folders %}

    {# Compare to folder.parent.name to get the string #}
    {% ifequal folder.parent.name "Dokumente" %}
      <h3>{{ folder }}</h3>
      <table class="table table-hover table-striped table-condensed table-responsive">
        <thead>
          <th>Name</th>
          <th></th>
          <th>Größe</th>
          <th>Hochgeladen am</th>
          <th>Zuletzt geändert</th>
        </thead>
        <tbody>
          {% for file in files %}
            {% ifequal file.folder folder %}
              <tr>
                <td>
                  <a href="{{ file.url }}">
                    {% if file.name %}
                      {{ file.name }}
                    {% else %}
                      {{ file }}
                    {% endif %}
                  </a>
                </td>
                <td>
                  {% if file.description %}
                    <a class="btn btn-default btn-xs" tabindex="0" data-toggle="popover" title="{{ file }}" data-content="{{ file.description }}">Info</a>
                  {% endif %}
                  {% if user.is_staff %}
                    <a href="{{ file.get_admin_url_path }}"><i class="fa fa-pencil-square-o fa-lg"></i></a>
                  {% endif %}
                </td>
                <td>{{ file.size|sizify }}</td>
                <td>{{ file.uploaded_at }}</td>
                <td>{{ file.modified_at }}</td>
              </tr>
            {% endifequal %}
          {% endfor %}

        </tbody>

      </table>
    {% endifequal %}

  {% endfor %}

  <script>
    $(document).ready(function(){
        $('[data-toggle="popover"]').popover();
    });
  </script>
{% endblock %}